# Fluent Python 分析笔记

## 7 Functions as First-Class Objects

### 这一章的大纲是什么

- 把函数视为对象
- 高阶函数
- 匿名函数
- 9种可调用对象
- 用户自定义的可调用类型
- 从位置参数到仅限关键字的参数
- 函数式编程的包

### 目前为止我知道什么

备注：在我回答这个问题时，我已经看过第7章的部分内容了。

- 把函数视为对象，是指：
  - 函数可以在运行时创建
  - 函数可以赋值给变量
  - 函数可以作为其他函数的输入参数
  - 函数可以作为其他函数的返回值

- 高阶函数是指接收函数作为输入参数的函数，比如 `sorted(arr, key=len)`（注：还有返回值为函数的函数）
- 匿名函数即没有名字的函数，比如 lambda 函数？有哪些应用场景？
- 9种可调用对象，其实是将函数或方法分成9种，包括
  - 用户自定义函数、用户自定义方法
  - 内建函数、内建方法（`dict.get()`）
  - 类（`SomeClass()`）、类实体（`some_instance()`）
  - 生成器函数（`yield`）、异步函数（`async def`）、异步生成器函数（`async def + yield`）？
- 位置参数、仅限关键字的参数：Python 函数参数可以通过 `/` 或 `*` 分隔符来指定函数类型，具体语法忘记了。

### 目前为止我不知道什么

- 匿名函数在 Python 中的应用场景有哪些？
- 生成器函数是什么？
- 异步函数的用法是怎样的？
- 异步生成器函数的用法是怎样的？
- 位置参数、仅限关键字的参数语法是怎样的？
- 函数式编程的包有哪些？

### 这一章的主要内容是什么

- 一级对象的函数
  - 可以在运行时创建
  - 可以赋值给一个数据结构里的变量或元素
  - 可以作为函数输入的参数
  - 可以作为函数返回的结果

- 高阶函数指输入参数或返回值为函数的函数。比如 map，filter 和 reduce。
  - map 可以用列表推导式代替，比如 `[f(x) for x in S]`
  - filter 也可以用列表推导式代替，比如 `[f(x) for x in S if xxx]`
  - reduce 可以用 `sum(iterable)`，`all(iterable)` 和 `any(iterable)` 代替

> 伍注：高阶一般含有递归的味道，比如阶乘就是递归乘以更小元素的阶乘，多阶导数就是上一阶导数的导数。

- 匿名函数
  - 使用 lambda 关键字创建
  - 最常用的地方是作为高阶函数的输入参数。比如 `sorted(fruits, key=lambda word: word[::-1])`
  - 重构 lambda 四部曲：写注释 -> 将注释转化为名字 -> 以此名字作为函数名定义一个函数 -> 去除注释

- 9种可调用对象
  - 用户自定义函数：通过 `def` 或 `lambda` 定义
  - 内建函数：使用 C 语言实现，比如 `len` 或 `time.strftime`
  - 内建方法：使用 C 语言实现，比如 `dict.get`
  - 方法
  - 类：被调用时，会调用其 `__new__` 方法来创建实体
  - 类实体：当这个类定义 `__call__` 方法时，类实体便可像函数被调用
  - 生成器函数：含有 yield 关键字的函数
  - 协程函数：通过 async def 定义的函数
  - 异步生成器函数：通过 async def 定义并且内部含有 yield 关键字的函数

- `callable()` 可以判断是否可调用

- 指定参数类型
  - `*` 代表可迭代参数（列表）
  - `**` 代表映射参数（字典）
  - `/` 前面的都是位置参数，比如：`def divmod(a, b, /)`
  - `*` 后面的都是关键字参数，比如：`def f(a, *, b)`

### 这一章的知识本质、第一原则和结构是什么

第7章的知识本质是：Python 函数是一级对象。

第7章的知识第一原则：充分利用「Python 函数是一级对象」来写出优雅的 Python 代码。

第7章的知识结构是：
Python 函数是一级对象的四个特点：动态创建、赋值、传参、返回值；
Python 函数是一级对象的体现：高阶函数、匿名函数、函数式编程包；
函数分类、函数参数。
